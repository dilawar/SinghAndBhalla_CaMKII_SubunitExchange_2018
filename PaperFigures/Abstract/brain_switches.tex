\RequirePackage{luatex85,shellesc}
\documentclass[crop,tikz]{standalone}
\usepackage{pgfplots}
\usepackage{ifthen}
\usetikzlibrary{arrows,arrows.meta}
\usepackage{circuitikzgit}

\usetikzlibrary{calc,arrows,arrows.meta}
\begin{document}

\newcommand\SWITCH[6]{ % name, x, y, width, rotation, on-off
    \edef\y{0.2}
    \ifthenelse{#6=1}{\edef\y{0.1}}{}
    \begin{scope}[xshift=-#2, yshift=-#3, rotate=#5]
        \draw[-Circle,line width=#4] (0 cm,0 cm) node (#1_a) {} -- (1 cm,0);
        \draw[Circle-,line width=#4] (1.5 cm,0) -- (2.5 cm,0) node (#1_b) {};
        \draw[line width=#4] (1 cm,\y cm) -- (1.5 cm,\y cm);
        \draw[line width=#4] (1.25 cm,\y cm) -- ++(0,0.2 cm);
    \end{scope}
}

\begin{tikzpicture}[scale=1, rotate=-45, every node/.style={} ]
    
    % Draw synapse. Pre synaptic side.
    \begin{scope}[rotate=-90]
        \draw[color=red!30,very thick, fill=red!10] plot[smooth] coordinates { 
            (-3,-8) (-3,-4) (-7,-2) (-7,1) 
            (0,1) (3,1) (2.5,-3) (-1,-4) (-1,-8) 
        };
    \end{scope}

    % Post synaptic side.
    \begin{scope}[yshift=4.3cm, xshift=2.75cm, rotate=90]
        \draw[color=red!40, very thick, fill=red!15] plot[smooth] coordinates { 
            (-3,-8) (-3,-4) (-7,-2) (-7,1) 
            (0,1) (2,1) (3,1) (2.5,-3.1) 
            (-1,-3.5) (-1,-8) 
        };
        \draw[draw=none, fill=red!30] plot[smooth] coordinates { 
            (-6.5,0) (-6.3,1.1) (0,1.05) (2,1) (2.5,1) (2,0) (-4,0.5) (-6.5,0)
        };
    \end{scope}

    % switches
    \edef\CLR{blue!80}
    \foreach[count=\i] \y in {-1.5,1,3.5,6}
    {
        \pgfmathsetmacro{\LW}{2}
        \pgfmathsetmacro{\AA}{rnd}
        \ifdim\AA pt<0.4pt
            \ctikzset{bipoles/pushbutton/height=1}
            \draw[line width=\LW pt, \CLR, smooth] (2,\y) -- (2.5,\y) to[push button,
                color=blue] (4,\y);
        \else
            \ctikzset{bipoles/pushbutton/height=0.5}
            \draw[line width=\LW pt, \CLR, smooth] (2,\y) -- (2.5,\y) to[push button,
                color=blue] (4,\y);
        \fi

        \draw[{Arc Barb[reversed,width=5mm]}-,line width=\LW pt, \CLR] (1.8,\y) -- (2,\y);

        % path.
        \pgfmathsetmacro\ynew{2.25+(\i-2.5)}
        \draw[color=\CLR, thick ] plot[smooth] coordinates {
            (4,\y) (5,\ynew) (6,2+0.1*\y) 
        };
    }

    \edef\y{0}
    \draw[color=\CLR, very thick,dashed] (4,\y) node[circle,draw,left,dotted]
        {$\int dt$} to[bend left] (6,2+0.1*\y);

    \edef\y{4.5}
    \draw[color=\CLR, very thick,dashed] (4,\y) node[circle,draw,left,dotted]
        {$\int dt$} 
        to[bend right] (6,2+0.1*\y);


    % Add all
    \node[fill=blue!10,circle,draw=blue] (int) at (6.25,2.25) {\Huge $\sum$};
    % \draw[-latex, line width=4pt, blue] (int) -- ++(3,0);

    % Pre synaptic side fill-in.
    \tikzset{every path/.style={line width=3pt,dashed}}
    \tikzset{pre/.style={-{o[width=5pt]},very thick}}

    %%\draw[pre,color=blue!20,] plot[smooth] coordinates { 
    %%    (-8,1.3) (-6,1.4) (-4.5,1.3) (-3.5,0.9) (-2.5,-1) (1.25,-2)
    %%    };
    %%\draw[pre,color=blue!20] plot[smooth] coordinates { 
    %%    (-8,1.4) (-6,1.5) (-4.5,1.4) (-3.5,1.1) (-2.5,-0) (1.1,-1)
    %%    };
    %%\draw[pre,color=blue!20] plot[smooth] coordinates { 
    %%    (-8,1.6) (-6,1.6) (-4.5,1.6) (-3.5,1.4) (-2.5,1) (1,0.5)
    %%    };
    %%\draw[pre,color=blue!20] plot[smooth] coordinates { 
    %%    (-8,1.9) (-6,1.8) (-4.5,1.8) (-3.5,1.8) (-2.5,2.5) (1,3)
    %%    };
    %%\draw[pre,color=blue!20] plot[smooth] coordinates { 
    %%    (-8,2.2) (-6,2.0) (-4.5,2.1) (-3.5,2.2) (-2.5,3.5) (1,5)
    %%    };
    %%\draw[pre,color=blue!20] plot[smooth] coordinates { 
    %%    (-8,2.6) (-6,2.5) (-4.5,2.6) (-3.5,2.7) (-2.5,4.5) (-1,6.5) (1,7)
    %%    };

    \foreach[count=\i] \j in {-5,-4,...,5}
    {
        \draw[pre,color=blue!20] plot[smooth] coordinates { 
            (-8+0.1*rnd,1.15+0.15*\i) (-6,1.4+0.1*\i) 
            (-5+0.1*rnd,1.4+0.1*\i) 
            (-4+0.1*rnd,1.15+0.15*\i)
            (-3+0.1*rnd,-1.5+0.5*\i)
            (-2+0.1*rnd,-2.5+0.75*\i)
            (-1+0.1*rnd,-3+0.85*\i)
            (0+0.1*rnd,-3.3+0.9*\i)
            (1+0.1*rnd,-3.4+0.9*\i)
            };

    }

\end{tikzpicture}	


\end{document}

